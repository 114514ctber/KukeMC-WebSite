(()=>{var e={};e.id=327,e.ids=[327],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},41041:e=>{"use strict";e.exports=require("node:url")},40437:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>o}),a(82932),a(12701),a(35866);var s=a(23191),r=a(88716),l=a(37922),i=a.n(l),d=a(95231),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);a.d(t,n);let o=["",{children:["player",{children:["[username]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,82932)),"D:\\编程\\KukeMC-Website\\KukeMC-WebSite\\src\\app\\player\\[username]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,12701)),"D:\\编程\\KukeMC-Website\\KukeMC-WebSite\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\编程\\KukeMC-Website\\KukeMC-WebSite\\src\\app\\player\\[username]\\page.tsx"],x="/player/[username]/page",m={require:a,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/player/[username]/page",pathname:"/player/[username]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},25995:(e,t,a)=>{Promise.resolve().then(a.bind(a,59875))},48998:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},49423:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]])},94893:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},63685:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(62881).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},59875:(e,t,a)=>{"use strict";a.d(t,{default:()=>er});var s=a(10326),r=a(17577),l=a(35047),i=a(90434),d=a(33385),n=a(24846),o=a(88129),c=a(77506),x=a(41291),m=a(30123),p=a(33734),u=a(67427),h=a(62881);let b=(0,h.Z)("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var g=a(74975),f=a(79635),k=a(40617),v=a(58038),j=a(50949),y=a(85206),w=a(66697),N=a(96015),_=a(71709);let Z=(0,h.Z)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);var z=a(48998),$=a(59593),S=a(49423),C=a(63685),M=a(39730),P=a(94019),E=a(98091),D=a(69436);let q=(0,h.Z)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);var A=a(94893),L=a(41135),B=a(74690),F=a(20349),T=a(23495),U=a(60962),W=a(47602),K=a(77120),I=a(86527),R=a(8621),G=a(58080);let O=({username:e})=>{let[t,a]=(0,r.useState)({}),[l,i]=(0,r.useState)(!0),o=(0,r.useRef)(null);(0,r.useEffect)(()=>{(async()=>{if(e){i(!0);try{let t=await d.ZP.get(`/api/profile/${e}/contributions`);a(t.data)}catch(e){console.error("Failed to fetch contribution data",e)}finally{i(!1)}}})()},[e]);let x=new Date,m=function(e,t,a){let s=(0,K.Q)(e,a?.in);return isNaN(-364)?(0,W.L)(a?.in||e,NaN):(s.setDate(s.getDate()+t),s)}(x,-364,void 0),p=(0,r.useMemo)(()=>(function(e,t){let{start:a,end:s}=function(e,t){let[a,s]=(0,I.d)(e,t.start,t.end);return{start:a,end:s}}(void 0,e),r=+a>+s,l=r?+a:+s,i=r?s:a;i.setHours(0,0,0,0);let d=(void 0)??1;if(!d)return[];d<0&&(d=-d,r=!r);let n=[];for(;+i<=l;)n.push((0,W.L)(a,i)),i.setDate(i.getDate()+d),i.setHours(0,0,0,0);return r?n.reverse():n})({start:m,end:x}),[m,x]),u=(0,r.useMemo)(()=>Object.values(t).reduce((e,t)=>e+t,0),[t]),h=e=>0===e?"bg-slate-100 dark:bg-slate-800/50 border border-transparent hover:border-slate-300 dark:hover:border-slate-600":e<60?"bg-emerald-200/80 dark:bg-emerald-900/40 border border-emerald-200 dark:border-emerald-800/50":e<180?"bg-emerald-300 dark:bg-emerald-700/60 border border-emerald-300 dark:border-emerald-700/50":e<300?"bg-emerald-400 dark:bg-emerald-600/80 border border-emerald-400 dark:border-emerald-600/50 shadow-[0_0_8px_rgba(52,211,153,0.3)]":"bg-emerald-500 dark:bg-emerald-500 border border-emerald-500 shadow-[0_0_12px_rgba(16,185,129,0.4)]",b=(e,t)=>{let a=(0,R.WU)(e,"yyyy年MM月dd日",{locale:G.U});if(0===t)return(0,s.jsxs)("div",{className:"flex flex-col gap-1 min-w-[120px]",children:[s.jsx("span",{className:"font-medium text-slate-200 text-xs",children:a}),s.jsx("span",{className:"text-slate-400 text-xs",children:"无游戏记录"})]});let r=Math.floor(t/60),l=t%60,i="";return i=r>0?`${r}小时${l}分钟`:`${l}分钟`,(0,s.jsxs)("div",{className:"flex flex-col gap-1 min-w-[120px]",children:[s.jsx("span",{className:"font-medium text-white text-xs",children:a}),s.jsx("span",{className:"text-emerald-300 font-bold text-sm",children:i})]})},g=(0,r.useMemo)(()=>{let e=[],t=[];return p.forEach(a=>{0===(0,K.Q)(a,void 0).getDay()&&t.length>0&&(e.push(t),t=[]),t.push(a)}),t.length>0&&e.push(t),e},[p]),[f,k]=(0,r.useState)(null),v=(0,r.useRef)(null),j=(e,t,a)=>{let s=e.currentTarget.getBoundingClientRect();k({show:!0,x:s.left+s.width/2,y:s.top-6,content:b(t,a)})},y=()=>{k(null)},w=(0,r.useMemo)(()=>{let e=[];return g.forEach((t,a)=>{let s=t.find(e=>1===e.getDate());0===a?e.push({text:(0,R.WU)(t[0],"MMM",{locale:G.U}),index:a}):s&&e.push({text:(0,R.WU)(s,"MMM",{locale:G.U}),index:a})}),e},[g]);return(0,r.useEffect)(()=>{o.current&&(o.current.scrollLeft=o.current.scrollWidth)},[l,g]),(0,s.jsxs)(n.E.div,{ref:v,initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-panel p-6 rounded-3xl border border-white/20 dark:border-slate-800 bg-white/60 dark:bg-slate-900/60 backdrop-blur-xl shadow-xl relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-emerald-500/5 rounded-full blur-3xl -z-10 transform translate-x-1/2 -translate-y-1/2"}),f?.show&&(0,U.createPortal)((0,s.jsxs)("div",{className:"fixed z-[9999] pointer-events-none transform -translate-x-1/2 -translate-y-full px-3 py-2 bg-slate-800 text-white text-xs rounded-lg shadow-lg border border-slate-700/50 whitespace-nowrap",style:{left:f.x,top:f.y},children:[f.content,s.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-[-4px] w-2 h-2 bg-slate-800 rotate-45 border-r border-b border-slate-700/50"})]}),document.body),s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsx("h3",{className:"text-base font-semibold text-slate-900 dark:text-white flex items-center gap-2",children:l?s.jsx("div",{className:"h-6 w-48 bg-slate-200 dark:bg-slate-700 rounded animate-pulse"}):(0,s.jsxs)(s.Fragment,{children:["过去一年共活跃 ",Math.floor(u/60)," 小时"]})})}),l?s.jsx("div",{className:"w-full h-40 flex items-center justify-center",children:s.jsx(c.Z,{className:"animate-spin text-emerald-500 w-8 h-8"})}):(0,s.jsxs)("div",{className:"relative group/scroll",children:[s.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-12 bg-gradient-to-r from-white dark:from-slate-900 to-transparent z-10 pointer-events-none opacity-0 md:opacity-100 transition-opacity"}),s.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-12 bg-gradient-to-l from-white dark:from-slate-900 to-transparent z-10 pointer-events-none opacity-0 md:opacity-100 transition-opacity"}),s.jsx("div",{ref:o,className:"overflow-x-auto pb-4 hide-scrollbar scroll-smooth relative",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:(0,s.jsxs)("div",{className:"min-w-[800px] w-fit mx-auto px-4",children:[s.jsx("div",{className:"relative h-6 mb-2 ml-10 text-xs font-medium text-slate-400 dark:text-slate-500",children:w.map((e,t)=>s.jsx("div",{className:"absolute top-0 whitespace-nowrap",style:{left:`${19*e.index}px`},children:e.text},t))}),(0,s.jsxs)("div",{className:"flex gap-1.5",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-[4px] w-9 pr-2 text-[11px] text-right font-medium text-slate-400 dark:text-slate-500 shrink-0 pt-[1px]",children:[s.jsx("div",{className:"h-[15px]"}),s.jsx("div",{className:"h-[15px] flex items-center justify-end",children:"一"}),s.jsx("div",{className:"h-[15px]"}),s.jsx("div",{className:"h-[15px] flex items-center justify-end",children:"三"}),s.jsx("div",{className:"h-[15px]"}),s.jsx("div",{className:"h-[15px] flex items-center justify-end",children:"五"}),s.jsx("div",{className:"h-[15px]"})]}),s.jsx("div",{className:"flex gap-[4px] flex-1",children:g.map((e,a)=>s.jsx("div",{className:"flex flex-col gap-[4px]",children:e.map(e=>{let a=(0,R.WU)(e,"yyyy-MM-dd"),r=t[a]||0;return s.jsx("div",{className:(0,L.Z)("w-[15px] h-[15px] rounded-[3px] transition-all duration-300 relative cursor-pointer",h(r),"hover:scale-110 hover:z-10 hover:shadow-lg"),onMouseEnter:t=>j(t,e,r),onMouseLeave:y},a)})},a))})]})]})})]}),!l&&(0,s.jsxs)("div",{className:"flex items-center justify-end gap-3 mt-4 text-xs font-medium text-slate-500 dark:text-slate-400",children:[s.jsx("span",{className:"mr-1",children:"Less"}),(0,s.jsxs)("div",{className:"flex gap-1.5",children:[s.jsx("div",{className:"w-[15px] h-[15px] rounded-[2px] bg-slate-100 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700"}),s.jsx("div",{className:"w-[15px] h-[15px] rounded-[2px] bg-emerald-200 dark:bg-emerald-900/40 border border-emerald-300/30"}),s.jsx("div",{className:"w-[15px] h-[15px] rounded-[2px] bg-emerald-300 dark:bg-emerald-700/60 border border-emerald-400/30"}),s.jsx("div",{className:"w-[15px] h-[15px] rounded-[2px] bg-emerald-400 dark:bg-emerald-600/80 border border-emerald-500/30"}),s.jsx("div",{className:"w-[15px] h-[15px] rounded-[2px] bg-emerald-500 dark:bg-emerald-500 border border-emerald-400 shadow-[0_0_8px_rgba(16,185,129,0.3)]"})]}),s.jsx("span",{className:"ml-1",children:"More"})]}),s.jsx("style",{children:`
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
      `})]})};var Q=a(12390),H=a(2704),J=a(98231),X=a(91272),Y=a(76910),V=a(45213),ee=a(39183),et=a(24061);let ea=({isOpen:e,onClose:t,title:a,users:r,loading:l})=>s.jsx(o.M,{children:e&&s.jsx(s.Fragment,{children:s.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] flex items-center justify-center",children:(0,s.jsxs)(n.E.div,{initial:{opacity:0,scale:.95,y:0},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:0},onClick:e=>e.stopPropagation(),className:"w-full max-w-md bg-white dark:bg-slate-900 rounded-2xl shadow-2xl overflow-hidden max-h-[80vh] flex flex-col border border-slate-200 dark:border-slate-800 m-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-slate-100 dark:border-slate-800 bg-white/50 dark:bg-slate-900/50 backdrop-blur-sm",children:[s.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:a}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:s.jsx(P.Z,{size:20,className:"text-slate-500"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:l?s.jsx("div",{className:"flex justify-center py-12",children:s.jsx(c.Z,{size:32,className:"animate-spin text-emerald-500"})}):r.length>0?s.jsx("div",{className:"space-y-3",children:r.map(e=>(0,s.jsxs)(i.default,{href:`/player/${e.username}`,onClick:t,className:"flex items-center gap-4 p-3 hover:bg-slate-50 dark:hover:bg-slate-800/50 rounded-xl transition-all group border border-transparent hover:border-slate-100 dark:hover:border-slate-800",children:[s.jsx("div",{className:"relative",children:s.jsx("img",{src:`https://cravatar.eu/helmavatar/${e.username}/48.png`,alt:e.username,className:"w-12 h-12 rounded-xl shadow-sm group-hover:scale-105 transition-transform duration-300"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"font-bold text-slate-900 dark:text-white group-hover:text-emerald-500 transition-colors truncate text-base",children:e.nickname||e.username}),e.nickname&&e.nickname!==e.username&&s.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-slate-100 dark:bg-slate-800 text-slate-500 rounded font-mono",children:e.username})]}),s.jsx("div",{className:"text-xs text-slate-500 truncate mt-0.5",children:"访问主页"})]}),s.jsx("div",{className:"text-slate-300 group-hover:text-emerald-500 transition-colors",children:s.jsx(ee.Z,{size:18})})]},e.username))}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-slate-500",children:[s.jsx("div",{className:"w-16 h-16 bg-slate-50 dark:bg-slate-800/50 rounded-full flex items-center justify-center mb-4",children:s.jsx(et.Z,{size:24,className:"text-slate-300 dark:text-slate-600"})}),s.jsx("p",{children:"暂时没有用户"})]})})]})})})}),es=e=>{if(!e)return e;let t=e.split(".");if(t.length<2)return e;let a=t.pop();return`${t.join(".")}_thumb.${a}`},er=()=>{let e=(0,l.useParams)(),t=e?.username,a=(0,l.useSearchParams)(),h=(0,l.useRouter)();(0,l.usePathname)();let{error:U,success:W,warning:K}=(0,Y.p)(),{confirm:I}=(0,V.N)(),{user:R,token:G,loading:ee}=(0,B.a)(),[et,er]=(0,r.useState)(null),[el,ei]=(0,r.useState)(null),[ed,en]=(0,r.useState)(!0),[eo,ec]=(0,r.useState)(null),[ex,em]=(0,r.useState)([]),[ep,eu]=(0,r.useState)(!0),[eh,eb]=(0,r.useState)(""),[eg,ef]=(0,r.useState)(!1),[ek,ev]=(0,r.useState)(null),[ej,ey]=(0,r.useState)(""),[ew,eN]=(0,r.useState)(!1),[e_,eZ]=(0,r.useState)(null),[ez,e$]=(0,r.useState)([]),[eS,eC]=(0,r.useState)(!1),[eM,eP]=(0,r.useState)(!1),[eE,eD]=(0,r.useState)(null),[eq,eA]=(0,r.useState)(null),[eL,eB]=(0,r.useState)(null),[eF,eT]=(0,r.useState)(!1),[eU,eW]=(0,r.useState)(!1),eK=(0,r.useRef)(null),[eI,eR]=(0,r.useState)(0);(0,r.useEffect)(()=>{eq?.music_id&&(eB(null),eR(0),eT(!1),eW(!1),d.ZP.get(`/api/profile/music/${eq.music_id}`).then(e=>{eB(e.data)}).catch(e=>console.error(e)))},[eq?.music_id]),(0,r.useEffect)(()=>{if(eL&&eK.current){let e=eK.current;e.volume=.5;let t=async()=>{try{await e.play()}catch(e){console.log("Autoplay blocked:",e),eW(!0),eT(!1)}};return e.readyState>=3?t():e.addEventListener("canplay",t,{once:!0}),()=>{e.removeEventListener("canplay",t),e.pause()}}},[eL]),(0,r.useEffect)(()=>{let e=()=>{if(!eU)return;let e=eK.current;if(e&&e.paused){let t=e.play();t&&"function"==typeof t.catch&&t.catch(e=>{console.error("Interaction play failed",e)})}};return eU&&(document.addEventListener("click",e,{once:!0}),document.addEventListener("keydown",e,{once:!0}),document.addEventListener("touchstart",e,{once:!0})),()=>{document.removeEventListener("click",e),document.removeEventListener("keydown",e),document.removeEventListener("touchstart",e)}},[eU]);let[eG,eO]=(0,r.useState)([]),[eQ,eH]=(0,r.useState)(!0),[eJ,eX]=(0,r.useState)("overview"),[eY,eV]=(0,r.useState)([]),[e0,e1]=(0,r.useState)([]),[e2,e5]=(0,r.useState)({followers_count:0,following_count:0,is_following:!1}),[e4,e9]=(0,r.useState)(!1),[e3,e8]=(0,r.useState)(!1),[e6,e7]=(0,r.useState)([]),{level:te}=(0,X.h)(),[tt,ta]=(0,r.useState)({title:"",description:"",file:null}),[ts,tr]=(0,r.useState)(!1),[tl,ti]=(0,r.useState)(!1),[td,tn]=(0,r.useState)(null),[to,tc]=(0,r.useState)([]),[tx,tm]=(0,r.useState)(""),[tp,tu]=(0,r.useState)(!1),[th,tb]=(0,r.useState)(!1),[tg,tf]=(0,r.useState)({username:null,posts:{data:[],loaded:!1},collections:{data:[],loaded:!1}});(0,r.useEffect)(()=>{t&&(tA(t),tq(t))},[t]),(0,r.useEffect)(()=>{!ee&&t&&(tL(t),tE(t),tN(t),tk(t))},[t,G,ee]),(0,r.useEffect)(()=>{let e=a.get("tab");e&&["overview","posts","collections","albums"].includes(e)&&eX(e)},[a]),(0,r.useEffect)(()=>{tf({username:t||null,posts:{data:[],loaded:!1},collections:{data:[],loaded:!1}}),eV([]),e1([]),e7([])},[t]),(0,r.useEffect)(()=>{if(t){let e=tg.username===t;"posts"===eJ&&(e&&tg.posts.loaded?eV(tg.posts.data):tv(t)),"collections"===eJ&&(e&&tg.collections.loaded?e1(tg.collections.data):tj())}},[t,G,eJ,tg]);let tk=async e=>{try{let t=await (0,H.P0)(e);e5(t)}catch(e){console.error(e)}},tv=async e=>{e8(!0);try{let t=await (0,Q.Jq)({author:e});eV(t.data),tf(a=>({...a,username:e,posts:{data:t.data,loaded:!0}}))}catch(e){console.error(e)}finally{e8(!1)}},tj=async()=>{e8(!0);try{let e=await (0,Q.Jq)({is_collected:!0});e1(e.data),e7([]),tf(a=>({...a,username:t||a.username,collections:{data:e.data,loaded:!0}}))}catch(e){console.error(e)}finally{e8(!1)}},ty=async e=>{if(t){eC(!0),eZ(e),e$([]);try{let a=await d.ZP.get(`/api/social/${e}/${t}`);Array.isArray(a.data)?e$(a.data):a.data.data&&Array.isArray(a.data.data)&&e$(a.data.data)}catch(e){console.error(e)}finally{eC(!1)}}},tw=async()=>{if(t&&!e4){e9(!0);try{e2.is_following?(await (0,H.F6)(t),e5(e=>({...e,is_following:!1,followers_count:e.followers_count-1}))):(await (0,H.P_)(t),e5(e=>({...e,is_following:!0,followers_count:e.followers_count+1})))}catch(e){console.error(e)}finally{e9(!1)}}},tN=async e=>{eH(!0);try{let t=G?{headers:{Authorization:`Bearer ${G}`}}:{},a=await d.ZP.get(`/api/album/list/${e}`,{...t,params:{_t:Date.now()}});eO(a.data)}catch(e){console.error("Failed to fetch albums",e)}finally{eH(!1)}},t_=async e=>{if(e.preventDefault(),tt.file&&tt.title){ti(!0);try{let e=tt.file;if(e.size>5242880)try{if((e=await tZ(e)).size>5242880)throw Error("图片压缩后仍然超过5MB限制，请选择更小的图片")}catch(e){throw Error(e.message||"图片压缩失败")}let a=new FormData;a.append("file",e);let s=await (0,d.lY)(),r=await d.ZP.post("/api/upload/image",a,{headers:{"Content-Type":"multipart/form-data",...s}}),l=r.data.url,i=r.data.thumbnail_url;await d.ZP.post("/api/album/upload",{title:tt.title,description:tt.description,image_url:l,thumbnail_url:i},{headers:{Authorization:`Bearer ${G}`}}),tz(),t&&tN(t)}catch(e){alert(e.message||"上传失败")}finally{ti(!1)}}},tZ=e=>new Promise((t,a)=>{let s=new Image,r=new FileReader;r.onload=e=>{s.src=e.target?.result},r.onerror=a,s.onload=()=>{let r=document.createElement("canvas"),l=s.width,i=s.height;(l>1920||i>1920)&&(l>i?(i*=1920/l,l=1920):(l*=1920/i,i=1920)),r.width=l,r.height=i;let d=r.getContext("2d");if(!d){a(Error("Canvas context not available"));return}d.drawImage(s,0,0,l,i),r.toBlob(s=>{if(!s){a(Error("Compression failed"));return}t(new File([s],e.name.replace(/\.[^/.]+$/,"")+".jpg",{type:"image/jpeg",lastModified:Date.now()}))},"image/jpeg",.7)},s.onerror=a,r.readAsDataURL(e)}),tz=()=>{tr(!1),ta({title:"",description:"",file:null})},t$=async e=>{tn(e),tu(!0),tc([]);try{let t=G?{headers:{Authorization:`Bearer ${G}`}}:{},a=await d.ZP.get(`/api/album/${e.id}`,t);tc(Array.isArray(a.data.comments)?a.data.comments:[]),tn(e=>e?{...e,...a.data}:null)}catch(e){console.error(e),tc([])}finally{tu(!1)}},tS=async e=>{if(R)try{let t=await d.ZP.post(`/api/album/${e.id}/like`,{},{headers:{Authorization:`Bearer ${G}`}}),a=a=>a.id===e.id?{...a,likes:t.data.likes,is_liked:"liked"===t.data.status}:a;eO(e=>e.map(a)),td&&td.id===e.id&&tn(e=>e?a(e):null)}catch(e){alert(e.response?.data?.detail||"操作失败")}},tC=async e=>{if(R)try{let t=await d.ZP.post(`/api/album/${e.id}/collect`,{},{headers:{Authorization:`Bearer ${G}`}}),a=a=>a.id===e.id?{...a,is_collected:t.data.is_collected}:a;eO(e=>e.map(a)),t.data.is_collected?e7(t=>t.find(t=>t.id===e.id)?t:[{...e,is_collected:!0},...t]):e7(t=>t.filter(t=>t.id!==e.id)),td&&td.id===e.id&&tn(e=>e?a(e):null)}catch(e){alert(e.response?.data?.detail||"操作失败")}},tM=async e=>{if(e.preventDefault(),td&&tx.trim()){if(null!==te&&te<5){alert("您的等级不足 5 级，无法评论。请前往游戏内升级！");return}tb(!0);try{let e=await d.ZP.post(`/api/album/${td.id}/comment`,{content:tx},{headers:{Authorization:`Bearer ${G}`}});if(e.data.data)tc(t=>[...t||[],e.data.data]);else{let e=G?{headers:{Authorization:`Bearer ${G}`}}:{},t=await d.ZP.get(`/api/album/${td.id}`,e);tc(Array.isArray(t.data.comments)?t.data.comments:[])}tm(""),eO(e=>e.map(e=>e.id===td.id?{...e,comment_count:e.comment_count+1}:e))}catch(e){alert(e.response?.data?.detail||"评论失败")}finally{tb(!1)}}},tP=async e=>{if(await I({title:"删除照片",message:"确定要删除这张照片吗？此操作无法撤销。",isDangerous:!0,confirmText:"删除"}))try{await d.ZP.delete(`/api/album/${e}`,{headers:{Authorization:`Bearer ${G}`}}),td?.id===e&&tn(null),eO(t=>t.filter(t=>t.id!==e)),W("删除成功")}catch(e){U(e.response?.data?.detail||"删除失败")}},tE=async e=>{try{let t=G?{headers:{Authorization:`Bearer ${G}`}}:{},a=await d.ZP.get(`/api/profile/${e}`,{...t,params:{_t:Date.now()}});eA(a.data)}catch(e){console.error("Failed to fetch profile",e)}},tD=async()=>{if(R&&t)try{await d.ZP.post("/api/profile/like",{target_username:t},{headers:{Authorization:`Bearer ${G}`}}),tE(t)}catch(e){U(e.response?.data?.detail||"操作失败")}},tq=async e=>{try{let t=await d.ZP.get("/api/level/my-info",{params:{username:e}});ei(t.data)}catch(e){console.error("Failed to fetch level info",e)}},tA=async e=>{en(!0);try{let t=await d.ZP.get("/api/playtime/player/details",{params:{name:e}});er(t.data),ec(null)}catch(e){ec(e.response?.data?.error||"无法获取玩家信息"),er(null)}finally{en(!1)}},tL=async e=>{eu(!0);try{let t=(await d.ZP.get("/api/message/read",{params:{recipient:e}})).data,a=new Map,s=[];t.forEach(e=>{a.set(e.id,{...e,replies:[]})}),t.forEach(e=>{let t=a.get(e.id);if(e.parent_id){let r=a.get(e.parent_id);r?r.replies?.push(t):s.push(t)}else s.push(t)}),(e=>{e.sort((e,t)=>t.timestamp-e.timestamp),e.forEach(e=>{e.replies&&e.replies.length>0&&e.replies.sort((e,t)=>t.timestamp-e.timestamp)})})(s),em(s)}catch(e){console.error("Failed to load messages",e)}finally{eu(!1)}},tB=async e=>{if(R)try{let t=await d.ZP.post(`/api/message/${e}/like`,{},{headers:{Authorization:`Bearer ${G}`}}),a=s=>s.id===e?{...s,likes:t.data.likes,is_liked:t.data.liked}:s.replies?{...s,replies:s.replies.map(a)}:s;em(e=>e.map(a))}catch(e){console.error(e)}},tF=(0,r.useMemo)(()=>{let e=t=>({id:t.id,content:t.content,created_at:t.timestamp,author:{username:t.player,nickname:t.player,avatar:`https://cravatar.eu/helmavatar/${t.player}/48.png`},likes_count:t.likes,is_liked:t.is_liked,replies:(t.replies||[]).map(e),parent_id:t.parent_id||void 0});return ex.map(e)},[ex]),tT=async(e,a)=>{if(R&&t){if(null!==te&&te<5){U("您的等级不足 5 级，无法留言。请前往游戏内升级！");return}if(a){eN(!0);try{await d.ZP.post("/api/message/write",{message:e,player:R.username,recipient:t,parent_id:a},{headers:{Authorization:`Bearer ${G}`}}),tL(t),W("回复成功")}catch(e){throw U(e.response?.data?.error||"回复失败"),e}finally{eN(!1)}}else{ef(!0);try{await d.ZP.post("/api/message/write",{message:e,player:R.username,recipient:t,parent_id:null},{headers:{Authorization:`Bearer ${G}`}}),tL(t),W("留言发布成功")}catch(e){throw U(e.response?.data?.error||"发布失败"),e}finally{ef(!1)}}}},tU=async e=>{await tB(e)},tW=async e=>{await tK(e)},tK=async e=>{if(!await I({title:"删除留言",message:"确定要删除这条留言吗？此操作无法撤销。",isDangerous:!0,confirmText:"删除"}))return;let a=eE?`Bearer ${eE}`:G?`Bearer ${G}`:null;if(!a){U("无权删除");return}try{await d.ZP.delete(`/api/message/${e}`,{headers:{Authorization:a}}),t&&tL(t),W("删除成功")}catch(e){U("删除失败: "+(e.response?.data?.error||e.message))}},tI=e=>{eV(t=>t.map(t=>t.id===e.id?e:t)),e1(t=>t.some(t=>t.id===e.id)?e.is_collected?t.map(t=>t.id===e.id?e:t):t.filter(t=>t.id!==e.id):e.is_collected?[e,...t]:t),tf(t=>{let a=t.posts.data.map(t=>t.id===e.id?e:t),s=t.collections.data;return s.some(t=>t.id===e.id)?s=e.is_collected?s.map(t=>t.id===e.id?e:t):s.filter(t=>t.id!==e.id):e.is_collected&&(s=[e,...s]),{...t,posts:{...t.posts,data:a},collections:{...t.collections,data:s}}})},tR=e=>{eV(t=>t.filter(t=>t.id!==e)),e1(t=>t.filter(t=>t.id!==e)),tf(t=>({...t,posts:{...t.posts,data:t.posts.data.filter(t=>t.id!==e)},collections:{...t.collections,data:t.collections.data.filter(t=>t.id!==e)}}))},tG=e=>{let t;if(!e)return"未知日期";if("number"==typeof e)t=new Date(e<1e10?1e3*e:e);else{let a=String(e);if(a.includes(" +")?a=a.replace(" +","+"):a.includes(" -")&&(a=a.replace(" -","-")),isNaN((t=new Date(a)).getTime())&&/^\d+$/.test(e)){let a=parseInt(e);isNaN(a)||(t=new Date(a<1e10?1e3*a:a))}}if(isNaN(t.getTime())){if("string"==typeof e&&/^\d{4}-\d{2}-\d{2}/.test(e)){let t=new Date(e.substring(0,10));if(!isNaN(t.getTime()))return t.toLocaleDateString()}return String(e)}return t.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/\//g,"-")};if(ed)return s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx(c.Z,{size:40,className:"text-brand-500 animate-spin"})});if(eo||!et)return(0,s.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center p-4",children:[s.jsx(x.Z,{size:48,className:"text-red-500 mb-4"}),s.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-2",children:"未找到玩家"}),s.jsx("p",{className:"text-slate-500 mb-8",children:eo||"该玩家不存在或从未进入过服务器。"}),s.jsx(i.default,{href:"/stats",className:"px-6 py-2 bg-brand-500 text-white rounded-lg hover:bg-brand-600 transition-colors",children:"返回排行榜"})]});let tO=et.ban_history?.some(e=>e.active)||!1;return(0,s.jsxs)("div",{className:"min-h-screen py-12 px-4 sm:px-6 lg:px-8 pt-24",children:[(0,s.jsxs)("div",{className:"max-w-5xl mx-auto space-y-8",children:[(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:(0,L.Z)("relative overflow-hidden bg-white/80 dark:bg-slate-900/50 backdrop-blur-md rounded-3xl p-8 border shadow-xl transition-all duration-300",tO?"border-red-500/50 shadow-red-500/20":"border-slate-200 dark:border-slate-800"),children:[tO&&s.jsx("div",{className:"absolute -top-12 -right-12 z-10 pointer-events-none opacity-20 dark:opacity-10 rotate-12",children:s.jsx(m.Z,{size:300,className:"text-red-500"})}),s.jsx("div",{className:(0,L.Z)("absolute top-0 left-0 w-full h-32",tO?"bg-gradient-to-r from-red-500/20 to-orange-500/20 dark:from-red-900/40 dark:to-orange-900/40":"bg-gradient-to-r from-blue-500/10 to-purple-500/10 dark:from-blue-500/20 dark:to-purple-500/20")}),(0,s.jsxs)("div",{className:"relative flex flex-col md:flex-row gap-8 mt-4",children:[(0,s.jsxs)("div",{className:"relative group self-center md:self-end shrink-0",children:[(0,s.jsxs)("div",{className:(0,L.Z)("w-32 h-32 rounded-2xl overflow-hidden ring-4 shadow-2xl relative",tO?"ring-red-500 grayscale":"ring-white dark:ring-slate-900"),children:[s.jsx("img",{src:`https://cravatar.eu/helmavatar/${et.username}/256.png`,alt:et.username,className:"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500"}),tO&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/10",children:s.jsx(m.Z,{size:48,className:"text-red-500 drop-shadow-lg"})})]}),s.jsx("div",{className:(0,L.Z)("absolute -bottom-2 -right-2 w-8 h-8 rounded-full border-4 border-white dark:border-slate-900 flex items-center justify-center shadow-lg",et.online_now?"bg-green-500":"bg-slate-400"),title:et.online_now?"在线":"离线",children:et.online_now&&s.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-ping"})})]}),(0,s.jsxs)("div",{className:"flex-1 text-center md:text-left mb-2 self-center md:self-end flex flex-col md:flex-row md:items-end justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center md:justify-start gap-4 mb-2",children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold text-slate-900 dark:text-white flex items-center gap-3",children:[et.username,el&&(0,s.jsxs)("span",{className:`px-3 py-1 rounded-lg border ${(0,J.q)(el.level).bg} ${(0,J.q)(el.level).border} flex items-center gap-1.5`,children:[s.jsx(p.Z,{size:16,className:(0,J.q)(el.level).icon}),(0,s.jsxs)("span",{className:`text-sm font-bold ${(0,J.q)(el.level).icon}`,children:["Lv.",el.level]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[eq&&(0,s.jsxs)("button",{onClick:tD,disabled:!R||R.username===et.username,className:(0,L.Z)("flex items-center gap-1.5 px-3 py-1.5 rounded-full transition-all border",eq.is_liked?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 border-red-200 dark:border-red-800":"bg-slate-100 dark:bg-slate-800 text-slate-500 border-transparent hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",(!R||R.username===et.username)&&"opacity-50 cursor-not-allowed"),title:R?.username===et.username?"不能给自己点赞":eq.is_liked?"取消点赞":"点赞",children:[s.jsx(u.Z,{size:18,className:(0,L.Z)(eq.is_liked&&"fill-current")}),s.jsx("span",{className:"font-bold",children:eq.likes})]}),R&&R.username!==et.username&&s.jsx("button",{onClick:tw,disabled:e4,className:(0,L.Z)("flex items-center gap-1.5 px-3 py-1.5 rounded-full transition-all border",e2.is_following?"bg-slate-100 dark:bg-slate-800 text-slate-500 border-transparent hover:bg-red-50 hover:text-red-500 dark:hover:bg-red-900/20":"bg-emerald-500 text-white border-emerald-500 hover:bg-emerald-600 shadow-lg shadow-emerald-500/20"),children:e4?s.jsx(c.Z,{size:16,className:"animate-spin"}):e2.is_following?(0,s.jsxs)(s.Fragment,{children:[s.jsx(b,{size:16}),s.jsx("span",{className:"font-medium",children:"已关注"})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(g.Z,{size:16}),s.jsx("span",{className:"font-medium",children:"关注"})]})})]})]}),s.jsx("div",{className:"mb-4 text-slate-600 dark:text-slate-300 italic min-h-[1.5em]",children:eq?.signature?(0,s.jsxs)("span",{children:['"',eq.signature,'"']}):s.jsx("span",{className:"text-slate-400 dark:text-slate-500 text-sm",children:"这个人很懒，什么也没写..."})}),(0,s.jsxs)("div",{className:"flex flex-wrap justify-center md:justify-start gap-3 items-center",children:[(0,s.jsxs)("span",{className:"px-3 py-1 rounded-full bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 text-sm font-medium flex items-center gap-1.5",children:[s.jsx(f.Z,{size:14}),eq?.custom_title||"玩家"]}),et.qq?(0,s.jsxs)("span",{className:"px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 text-sm font-medium flex items-center gap-1.5",children:[s.jsx(k.Z,{size:14}),"QQ已绑定"]}):R&&R.username===et.username&&(0,s.jsxs)("button",{onClick:()=>{h.push("/settings")},className:"px-3 py-1 rounded-full bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 text-sm font-medium flex items-center gap-1.5 hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors cursor-pointer",children:[s.jsx(k.Z,{size:14}),"绑定QQ"]}),et.ban_count>0&&(0,s.jsxs)("span",{className:"px-3 py-1 rounded-full bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-sm font-medium flex items-center gap-1.5",children:[s.jsx(v.Z,{size:14}),et.ban_count," 次封禁记录"]}),et.warn_count>0&&(0,s.jsxs)("span",{className:"px-3 py-1 rounded-full bg-orange-50 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 text-sm font-medium flex items-center gap-1.5",children:[s.jsx(j.Z,{size:14}),et.warn_count," 次警告记录"]}),R&&R.username===et.username&&(0,s.jsxs)(i.default,{href:"/settings",className:"ml-2 px-3 py-1 rounded-full bg-emerald-50 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 text-sm font-medium flex items-center gap-1.5 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 transition-colors",children:[s.jsx(y.Z,{size:14}),"编辑资料"]})]}),tO&&(0,s.jsxs)("div",{className:"mt-4 bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center gap-3 text-red-600 dark:text-red-400 animate-pulse",children:[s.jsx(m.Z,{size:20,className:"shrink-0"}),s.jsx("span",{className:"font-medium text-sm",children:"此玩家已被服务器封禁"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center md:items-end gap-4 mt-4 md:mt-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,s.jsxs)("div",{onClick:()=>ty("following"),className:"flex flex-col items-center cursor-pointer group transition-all hover:-translate-y-0.5",children:[s.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-white group-hover:text-indigo-500 transition-colors",children:e2.following_count}),s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400 group-hover:text-indigo-400 transition-colors",children:"关注"})]}),s.jsx("div",{className:"w-px h-8 bg-slate-200 dark:bg-slate-700"}),(0,s.jsxs)("div",{onClick:()=>ty("followers"),className:"flex flex-col items-center cursor-pointer group transition-all hover:-translate-y-0.5",children:[s.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-white group-hover:text-indigo-500 transition-colors",children:e2.followers_count}),s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400 group-hover:text-indigo-400 transition-colors",children:"粉丝"})]})]}),(0,s.jsxs)("div",{className:"text-slate-500 dark:text-slate-400 text-xs uppercase tracking-wider flex items-center gap-2 bg-slate-50 dark:bg-slate-800/30 px-3 py-1 rounded-full",children:[s.jsx("span",{children:"最后登录"}),s.jsx("span",{className:"text-slate-900 dark:text-white font-medium font-mono",children:et.last_login?new Date(et.last_login).toLocaleDateString():"未知"})]})]})]})]}),s.jsx("div",{className:"absolute top-6 right-6 flex flex-wrap justify-end gap-2 max-w-[40%]",children:eq&&eq.tags&&eq.tags.length>0&&eq.tags.map((e,t)=>(0,s.jsxs)("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 border border-indigo-100 dark:border-indigo-800/50 whitespace-nowrap shadow-sm",children:["#",e]},t))})]}),(0,s.jsxs)("div",{className:"bg-white/80 dark:bg-slate-900/50 backdrop-blur-md p-2 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm flex justify-center gap-2 sm:gap-4 flex-wrap",children:[(0,s.jsxs)("button",{onClick:()=>eX("overview"),className:(0,L.Z)("px-6 py-2.5 rounded-xl font-medium transition-all duration-300 flex items-center gap-2.5 text-sm sm:text-base relative","overview"===eJ?"bg-slate-900 dark:bg-white text-white dark:text-slate-900 shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white"),children:[s.jsx(f.Z,{size:18}),"个人主页"]}),(0,s.jsxs)("button",{onClick:()=>eX("posts"),className:(0,L.Z)("px-6 py-2.5 rounded-xl font-medium transition-all duration-300 flex items-center gap-2.5 text-sm sm:text-base relative","posts"===eJ?"bg-slate-900 dark:bg-white text-white dark:text-slate-900 shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white"),children:[s.jsx(w.Z,{size:18}),"动态"]}),(0,s.jsxs)("button",{onClick:()=>eX("collections"),className:(0,L.Z)("px-6 py-2.5 rounded-xl font-medium transition-all duration-300 flex items-center gap-2.5 text-sm sm:text-base relative","collections"===eJ?"bg-slate-900 dark:bg-white text-white dark:text-slate-900 shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white"),children:[s.jsx(N.Z,{size:18}),"收藏"]}),(0,s.jsxs)("button",{onClick:()=>eX("albums"),className:(0,L.Z)("px-6 py-2.5 rounded-xl font-medium transition-all duration-300 flex items-center gap-2.5 text-sm sm:text-base relative","albums"===eJ?"bg-slate-900 dark:bg-white text-white dark:text-slate-900 shadow-md":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white"),children:[s.jsx(_.Z,{size:18}),"相册"]})]}),s.jsx(o.M,{mode:"wait",children:"overview"===eJ?(0,s.jsxs)(n.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3,ease:"easeOut"},className:"space-y-8",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white/80 dark:bg-slate-900/50 backdrop-blur-md p-6 rounded-2xl border border-slate-200 dark:border-slate-800 hover:border-purple-500/30 transition-colors group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/20 text-purple-500 rounded-xl group-hover:scale-110 transition-transform",children:s.jsx(Z,{size:24})}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"首次加入"}),s.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white truncate",title:et.first_seen,children:et.first_seen?new Date(et.first_seen).toLocaleDateString():"未知"})]})]}),(0,s.jsxs)("div",{className:"text-xs text-slate-500",children:["已陪伴服务器 ",Math.floor((Date.now()-new Date(et.first_seen).getTime())/864e5)," 天"]})]}),(0,s.jsxs)("div",{className:"bg-white/80 dark:bg-slate-900/50 backdrop-blur-md p-6 rounded-2xl border border-slate-200 dark:border-slate-800 hover:border-blue-500/30 transition-colors group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 text-blue-500 rounded-xl group-hover:scale-110 transition-transform",children:s.jsx(z.Z,{size:24})}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"总游戏时长"}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:[et.total_playtime_hours," ",s.jsx("span",{className:"text-sm font-normal text-slate-500",children:"小时"})]})]})]}),s.jsx("div",{className:"w-full bg-slate-100 dark:bg-slate-800 h-1.5 rounded-full overflow-hidden",children:s.jsx("div",{className:"bg-blue-500 h-full rounded-full",style:{width:"100%"}})})]}),(0,s.jsxs)("div",{className:"bg-white/80 dark:bg-slate-900/50 backdrop-blur-md p-6 rounded-2xl border border-slate-200 dark:border-slate-800 hover:border-emerald-500/30 transition-colors group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"p-3 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-500 rounded-xl group-hover:scale-110 transition-transform",children:s.jsx(w.Z,{size:24})}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"近30天活跃"}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:[et.days_played_30," ",s.jsx("span",{className:"text-sm font-normal text-slate-500",children:"天"})]})]})]}),s.jsx("div",{className:"w-full bg-slate-100 dark:bg-slate-800 h-1.5 rounded-full overflow-hidden",children:s.jsx("div",{className:"bg-emerald-500 h-full rounded-full",style:{width:`${et.days_played_30/30*100}%`}})})]}),(0,s.jsxs)("div",{className:"bg-white/80 dark:bg-slate-900/50 backdrop-blur-md p-6 rounded-2xl border border-slate-200 dark:border-slate-800 hover:border-amber-500/30 transition-colors group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"p-3 bg-amber-50 dark:bg-amber-900/20 text-amber-500 rounded-xl group-hover:scale-110 transition-transform",children:s.jsx(u.Z,{size:24})}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"获得总赞数"}),s.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:eq?.total_likes||0})]})]}),s.jsx("div",{className:"text-xs text-slate-500",children:"包括动态、相册、评论及主页获赞"})]})]}),s.jsx(O,{username:et.username}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white/80 dark:bg-slate-900/50 backdrop-blur-md p-6 rounded-2xl border border-slate-200 dark:border-slate-800",children:[(0,s.jsxs)("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(f.Z,{size:20,className:"text-slate-400"}),"个人简介"]}),s.jsx("div",{className:"text-slate-600 dark:text-slate-300 whitespace-pre-wrap leading-relaxed text-sm",children:eq?.bio||"暂无简介"})]}),eq&&eq.likers&&eq.likers.length>0&&(0,s.jsxs)("div",{className:"bg-white/80 dark:bg-slate-900/50 backdrop-blur-md p-6 rounded-2xl border border-slate-200 dark:border-slate-800",children:[(0,s.jsxs)("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx($.Z,{size:20,className:"text-slate-400"}),"最近点赞"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:eq.likers.map(e=>s.jsx(i.default,{href:`/player/${e}`,title:e,children:s.jsx("img",{src:`https://cravatar.eu/helmavatar/${e}/32.png`,className:"w-8 h-8 rounded-md border border-slate-200 dark:border-slate-700 hover:scale-110 transition-transform",alt:e})},e))})]}),(0,s.jsxs)("div",{className:"bg-white/80 dark:bg-slate-900/50 backdrop-blur-md p-6 rounded-2xl border border-slate-200 dark:border-slate-800",children:[(0,s.jsxs)("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(S.Z,{size:20,className:"text-slate-400"}),"基础信息"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"UUID"}),s.jsx("div",{className:"font-mono text-xs sm:text-sm bg-slate-100 dark:bg-slate-950 p-2 rounded select-all text-slate-700 dark:text-slate-300 break-all",children:et.uuid})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"绑定的QQ"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-300",children:[s.jsx(k.Z,{size:16}),s.jsx("span",{children:et.qq||"未绑定"})]})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"最近活跃 (7天)"}),(0,s.jsxs)("div",{className:"text-slate-700 dark:text-slate-300",children:[et.recent_week_hours," 小时 (",et.recent_week_minutes," 分钟)"]})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"最后登出"}),s.jsx("div",{className:"text-slate-700 dark:text-slate-300 font-mono text-sm",children:et.last_logout?new Date(et.last_logout).toLocaleString():"未知"})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"登录次数"}),(0,s.jsxs)("div",{className:"text-slate-700 dark:text-slate-300 font-mono text-sm",children:[et.login_count," 次"]})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"最近游玩"}),s.jsx("div",{className:"text-slate-700 dark:text-slate-300 font-mono text-sm",children:et.last_play_date||"未知"})]})]})]}),(et.warn_count>0||et.ban_count>0)&&(0,s.jsxs)("div",{className:"bg-white/80 dark:bg-slate-900/50 backdrop-blur-md p-6 rounded-2xl border border-slate-200 dark:border-slate-800",children:[(0,s.jsxs)("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(j.Z,{size:20,className:"text-slate-400"}),"违规记录"]}),(0,s.jsxs)("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-1 custom-scrollbar",children:[et.ban_history&&et.ban_history.map((e,t)=>(0,s.jsxs)("div",{className:"p-3 bg-red-50 dark:bg-red-900/10 rounded-xl border border-red-100 dark:border-red-900/30",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"px-1.5 py-0.5 bg-red-500 text-white text-[10px] rounded font-bold uppercase",children:"封禁"}),s.jsx("span",{className:"text-xs text-red-600 dark:text-red-400 font-medium",children:tG(e.time||e.created)})]}),s.jsx("div",{className:"text-sm text-slate-700 dark:text-slate-300 font-medium mb-1 break-words",children:e.reason}),(0,s.jsxs)("div",{className:"flex justify-between items-center text-xs text-slate-500",children:[(0,s.jsxs)("span",{children:["操作: ",e.banned_by_name]}),s.jsx("span",{children:e.active?"生效中":"已过期"})]})]},`ban-${t}`)),et.warn_history&&et.warn_history.map((e,t)=>(0,s.jsxs)("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/10 rounded-xl border border-orange-100 dark:border-orange-900/30",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"px-1.5 py-0.5 bg-orange-500 text-white text-[10px] rounded font-bold uppercase",children:"警告"}),s.jsx("span",{className:"text-xs text-orange-600 dark:text-orange-400 font-medium",children:tG(e.time||e.created_at)})]}),s.jsx("div",{className:"text-sm text-slate-700 dark:text-slate-300 font-medium mb-1 break-words",children:e.reason}),(0,s.jsxs)("div",{className:"flex justify-between items-center text-xs text-slate-500",children:[(0,s.jsxs)("span",{children:["操作: ",e.operator]}),e.kicked&&s.jsx("span",{children:"已踢出"})]})]},`warn-${t}`))]})]})]}),s.jsx("div",{className:"lg:col-span-2",children:s.jsx(T.Z,{comments:tF,currentUser:R,onSubmit:tT,onDelete:tW,onLike:tU,loading:ep,title:"留言板",className:"bg-white/80 dark:bg-slate-900/50 backdrop-blur-md border border-slate-200 dark:border-slate-800 h-full"})})]})]},"overview"):"posts"===eJ?s.jsx(n.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3,ease:"easeOut"},className:"space-y-6",children:s.jsx("div",{className:"grid grid-cols-1 gap-6",children:e3?s.jsx("div",{className:"flex justify-center py-12",children:s.jsx(c.Z,{size:32,className:"animate-spin text-emerald-500"})}):eY&&eY.length>0?eY.map(e=>s.jsx(F.Z,{post:e,onUpdate:tI,onDelete:tR},`${e.type||"post"}-${e.id}`)):s.jsx("div",{className:"text-center py-12 bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700",children:s.jsx("p",{className:"text-slate-500",children:"暂时没有动态"})})})},"posts"):"collections"===eJ?s.jsx(n.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3,ease:"easeOut"},className:"space-y-6",children:s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:e3?s.jsx("div",{className:"flex justify-center py-12 col-span-full",children:s.jsx(c.Z,{size:32,className:"animate-spin text-emerald-500"})}):0===(e0?.length||0)&&0===(e6?.length||0)?s.jsx("div",{className:"text-center py-12 bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 col-span-full",children:s.jsx("p",{className:"text-slate-500",children:"暂时没有收藏的内容"})}):s.jsx(s.Fragment,{children:[...(e0||[]).map(e=>({type:e.type||"post",data:e,date:e.created_at})),...(e6||[]).map(e=>({type:"album",data:e,date:e.created_at}))].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).map((e,t)=>s.jsx("div",{className:"h-full",children:"post"===e.type?s.jsx(i.default,{href:`/activity/${e.data.id}`,className:"block group h-full",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-900 rounded-xl overflow-hidden border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md transition-all duration-300 h-full flex flex-col relative aspect-square",children:[s.jsx("div",{className:"absolute top-2 right-2 z-10",children:(0,s.jsxs)("span",{className:"px-2 py-1 bg-black/40 backdrop-blur-sm text-white text-[10px] rounded-full flex items-center gap-1",children:[s.jsx(w.Z,{size:10}),"动态"]})}),e.data.images&&e.data.images.length>0?(0,s.jsxs)("div",{className:"relative h-[60%] overflow-hidden bg-slate-100 dark:bg-slate-800 flex-shrink-0",children:[s.jsx("img",{src:e.data.images[0],alt:e.data.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),e.data.images.length>1&&(0,s.jsxs)("div",{className:"absolute bottom-2 right-2 bg-black/50 text-white text-xs px-2 py-0.5 rounded-full backdrop-blur-sm",children:["+",e.data.images.length-1]})]}):(0,s.jsxs)("div",{className:"h-[60%] p-4 bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 dark:from-indigo-900/20 dark:via-purple-900/20 dark:to-pink-900/20 border-b border-slate-100 dark:border-slate-800 flex flex-col justify-center items-center text-center relative overflow-hidden flex-shrink-0",children:[s.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-30",style:{backgroundImage:"radial-gradient(circle at 2px 2px, rgba(0,0,0,0.05) 1px, transparent 0)",backgroundSize:"16px 16px"}}),s.jsx(k.Z,{size:24,className:"text-indigo-400/50 mb-2 relative z-10"}),s.jsx("h3",{className:"font-bold text-slate-800 dark:text-slate-200 line-clamp-2 relative z-10 px-2 text-sm",children:e.data.title})]}),(0,s.jsxs)("div",{className:"p-3 flex-1 flex flex-col justify-between overflow-hidden",children:[(0,s.jsxs)("div",{children:[e.data.images&&e.data.images.length>0&&s.jsx("h3",{className:"font-bold text-slate-900 dark:text-white mb-1 line-clamp-1 group-hover:text-emerald-600 dark:group-hover:text-emerald-400 transition-colors text-sm",children:e.data.title}),s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 line-clamp-2 mb-2",children:e.data.content.replace(/[#*`]/g,"")})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-slate-100 dark:border-slate-800 mt-auto",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx("img",{src:`https://cravatar.eu/helmavatar/${e.data.author.username}/24.png`,className:"w-5 h-5 rounded-full flex-shrink-0",alt:e.data.author.username}),s.jsx("span",{className:"text-xs text-slate-500 truncate",children:e.data.author.nickname||e.data.author.username})]}),s.jsx("div",{className:"flex items-center gap-3 text-xs text-slate-400 flex-shrink-0",children:(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[s.jsx(u.Z,{size:12,className:(0,L.Z)(e.data.is_liked&&"fill-red-500 text-red-500")}),e.data.likes_count]})})]})]})]})}):(0,s.jsxs)("div",{className:"group relative rounded-xl overflow-hidden bg-slate-100 dark:bg-slate-800 cursor-pointer border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-md transition-all h-full flex flex-col aspect-square",onClick:()=>t$(e.data),children:[(0,s.jsxs)("div",{className:"relative h-[75%] overflow-hidden flex-shrink-0",children:[s.jsx("div",{className:"absolute top-2 right-2 z-10",children:(0,s.jsxs)("span",{className:"px-2 py-1 bg-black/40 backdrop-blur-sm text-white text-[10px] rounded-full flex items-center gap-1",children:[s.jsx(_.Z,{size:10}),"相册"]})}),s.jsx("img",{src:es(e.data.image_url),alt:e.data.description||e.data.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",onError:t=>{t.target.src=e.data.image_url}}),(0,s.jsxs)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-4",children:[s.jsx("h4",{className:"text-white font-bold text-sm line-clamp-1 mb-1",children:e.data.title}),s.jsx("p",{className:"text-slate-200 text-xs line-clamp-2",children:e.data.description})]})]}),(0,s.jsxs)("div",{className:"p-3 bg-white dark:bg-slate-900 flex items-center justify-between flex-1 border-t border-slate-100 dark:border-slate-800",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx("img",{src:`https://cravatar.eu/helmavatar/${e.data.author?.username||e.data.username}/24.png`,className:"w-5 h-5 rounded-full flex-shrink-0",alt:e.data.author?.username||e.data.username}),s.jsx("span",{className:"text-xs text-slate-500 truncate",children:e.data.author?.nickname||e.data.author?.username||e.data.username})]}),s.jsx("div",{className:"flex items-center gap-3 text-xs text-slate-400 flex-shrink-0",children:(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[s.jsx(u.Z,{size:12,className:(0,L.Z)(e.data.is_liked&&"fill-red-500 text-red-500")}),void 0!==e.data.likes_count?e.data.likes_count:e.data.likes]})})]})]})},`${e.type}-${e.data.id}-${t}`))})})},"collections"):(0,s.jsxs)(n.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3,ease:"easeOut"},className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 bg-white/80 dark:bg-slate-900/50 backdrop-blur-md p-6 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[s.jsx(_.Z,{className:"text-purple-500",size:28}),et.username," 的相册"]}),(0,s.jsxs)("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:["共 ",eG.length," 张照片 • 收获 ",eG.reduce((e,t)=>e+t.likes,0)," 个赞"]})]}),R&&R.username===et.username&&(0,s.jsxs)("button",{onClick:()=>tr(!0),className:"px-6 py-2.5 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-xl font-medium shadow-lg hover:shadow-xl transition-all hover:scale-105 active:scale-95 flex items-center gap-2",children:[s.jsx(C.Z,{size:18}),"上传新照片"]})]}),eQ?s.jsx("div",{className:"flex justify-center py-24",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[s.jsx(c.Z,{size:48,className:"text-purple-500 animate-spin"}),s.jsx("p",{className:"text-slate-500",children:"加载精彩瞬间..."})]})}):0===eG.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-24 bg-white/50 dark:bg-slate-900/30 rounded-3xl border-2 border-dashed border-slate-200 dark:border-slate-800",children:[s.jsx("div",{className:"w-24 h-24 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center justify-center mb-6",children:s.jsx(_.Z,{size:40,className:"text-slate-300 dark:text-slate-600"})}),s.jsx("h3",{className:"text-xl font-medium text-slate-900 dark:text-white mb-2",children:"相册空空如也"}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 max-w-sm text-center mb-8",children:R&&R.username===et.username?"快来分享你在服务器里的第一个精彩瞬间吧！":"这位玩家还没有上传过任何照片，稍后再来看看吧。"}),R&&R.username===et.username&&s.jsx("button",{onClick:()=>tr(!0),className:"px-6 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"立即上传"})]}):s.jsx("div",{className:"columns-1 md:columns-2 lg:columns-3 gap-6 space-y-6",children:eG.map(e=>(0,s.jsxs)("div",{className:"break-inside-avoid group relative bg-white dark:bg-slate-900 rounded-2xl overflow-hidden border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-xl hover:shadow-purple-500/10 transition-all duration-300 cursor-pointer",onClick:()=>t$(e),children:[(0,s.jsxs)("div",{className:"relative aspect-auto overflow-hidden",children:[s.jsx("img",{src:es(e.image_url),alt:e.title,className:"w-full h-auto object-cover transition-transform duration-700 group-hover:scale-105",loading:"lazy",onError:t=>{t.target.src=e.image_url}}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),(0,s.jsxs)("div",{className:"p-4",children:[s.jsx("h4",{className:"font-bold text-slate-900 dark:text-white mb-1 line-clamp-1 group-hover:text-purple-500 transition-colors",children:e.title}),e.description&&s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 line-clamp-2 mb-3",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-slate-100 dark:border-slate-800",children:[s.jsx("div",{className:"text-xs text-slate-400",children:new Date(e.created_at).toLocaleDateString()}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-sm text-slate-500",children:[(0,s.jsxs)("span",{className:(0,L.Z)("flex items-center gap-1",e.is_liked&&"text-red-500"),children:[s.jsx(u.Z,{size:14,className:(0,L.Z)(e.is_liked&&"fill-current")}),e.likes]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[s.jsx(M.Z,{size:14}),e.comment_count]})]})]})]})]},e.id))})]},"albums")}),(0,s.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-900/50 rounded-xl p-4 flex items-start gap-3",children:[s.jsx(j.Z,{className:"text-red-500 shrink-0 mt-0.5",size:20}),(0,s.jsxs)("div",{children:[s.jsx("h4",{className:"font-bold text-red-600 dark:text-red-400 text-sm mb-1",children:"文明用语提醒"}),s.jsx("p",{className:"text-sm text-red-500/80 dark:text-red-400/80",children:"请在个人简介、签名及留言中保持文明用语。严禁发布广告、辱骂、色情或政治敏感内容。 违规者将被永久封禁账号并清空所有数据。"})]})]})]}),s.jsx(ea,{isOpen:null!==e_,onClose:()=>eZ(null),title:"following"===e_?"关注列表":"粉丝列表",users:ez,loading:eS}),s.jsx(o.M,{children:ts&&(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/60 backdrop-blur-md",onClick:()=>tr(!1)}),(0,s.jsxs)(n.E.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},className:"relative bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden border border-slate-200 dark:border-slate-800",children:[(0,s.jsxs)("div",{className:"px-8 py-6 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"上传新照片"}),s.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm mt-1",children:"分享你在服务器里的精彩瞬间"})]}),s.jsx("button",{onClick:tz,className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors",title:"关闭",children:s.jsx(P.Z,{size:24})})]}),(0,s.jsxs)("form",{onSubmit:t_,className:"p-8 space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:["照片标题 ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",required:!0,value:tt.title,onChange:e=>ta({...tt,title:e.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-white focus:ring-2 focus:ring-slate-900 dark:focus:ring-white focus:border-transparent transition-all placeholder:text-slate-400",placeholder:"给这张照片起个好听的名字..."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:["照片描述 ",s.jsx("span",{className:"text-slate-400 font-normal",children:"(选填)"})]}),s.jsx("textarea",{value:tt.description,onChange:e=>ta({...tt,description:e.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-white focus:ring-2 focus:ring-slate-900 dark:focus:ring-white focus:border-transparent h-32 resize-none transition-all placeholder:text-slate-400",placeholder:"这张照片背后有什么故事？说来听听..."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300",children:["选择图片 ",s.jsx("span",{className:"text-red-500",children:"*"})]}),(0,s.jsxs)("div",{className:"relative group",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:e=>ta({...tt,file:e.target.files?e.target.files[0]:null}),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),s.jsx("div",{className:(0,L.Z)("w-full border-2 border-dashed rounded-xl p-8 flex flex-col items-center justify-center gap-3 transition-all",tt.file?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/10":"border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-950 group-hover:border-slate-400 dark:group-hover:border-slate-600"),children:tt.file?(0,s.jsxs)(s.Fragment,{children:[s.jsx(_.Z,{size:32,className:"text-emerald-500"}),(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("p",{className:"font-medium text-emerald-700 dark:text-emerald-400",children:tt.file.name}),s.jsx("p",{className:"text-xs text-emerald-600/70 dark:text-emerald-400/70 mt-1",children:"点击可更换图片"}),(0,s.jsxs)("p",{className:"text-xs text-slate-400 mt-1",children:[(tt.file.size/1024/1024).toFixed(2)," MB"]})]})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-full shadow-sm",children:s.jsx(C.Z,{size:24,className:"text-slate-400"})}),(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("p",{className:"font-medium text-slate-600 dark:text-slate-300",children:"点击或拖拽上传图片"}),s.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"支持 JPG, PNG, GIF 格式 (自动压缩)"})]})]})})]})]}),(0,s.jsxs)("div",{className:"pt-6 flex justify-end gap-4 border-t border-slate-100 dark:border-slate-800",children:[s.jsx("button",{type:"button",onClick:tz,className:"px-6 py-2.5 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-xl transition-colors font-medium",children:"取消"}),s.jsx("button",{type:"submit",disabled:tl||!tt.file,className:"px-8 py-2.5 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-xl hover:opacity-90 disabled:opacity-50 flex items-center gap-2 font-bold shadow-lg hover:shadow-xl transition-all hover:-translate-y-0.5",children:tl?(0,s.jsxs)(s.Fragment,{children:[s.jsx(c.Z,{size:18,className:"animate-spin"}),"处理中..."]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(C.Z,{size:18}),"发布照片"]})})]})]})]})]})}),s.jsx(o.M,{children:td&&(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>tn(null)}),(0,s.jsxs)(n.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"relative bg-white dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-7xl overflow-hidden border border-slate-200 dark:border-slate-800 flex flex-col md:flex-row max-h-[90vh]",children:[s.jsx("button",{onClick:()=>tn(null),className:"absolute top-4 right-4 z-10 p-2 bg-black/50 text-white rounded-full hover:bg-black/70 transition-colors md:hidden",title:"关闭",children:s.jsx(P.Z,{size:20})}),(0,s.jsxs)("div",{className:"flex-[1.5] bg-black flex items-center justify-center overflow-hidden relative group",children:[s.jsx("img",{src:td.image_url,alt:td.title,className:"max-w-full max-h-[50vh] md:max-h-full object-contain"}),R&&(R.username===td.username||eM)&&s.jsx("button",{onClick:()=>tP(td.id),className:"absolute top-4 right-4 p-2 bg-red-500/80 text-white rounded-lg hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100",title:"删除图片",children:s.jsx(E.Z,{size:20})})]}),(0,s.jsxs)("div",{className:"w-full md:w-[400px] flex flex-col bg-white dark:bg-slate-900 border-l border-slate-200 dark:border-slate-800",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-slate-200 dark:border-slate-800 flex-shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-1",children:td.title}),(0,s.jsxs)("div",{className:"text-sm text-slate-500 flex items-center gap-2",children:[s.jsx("span",{children:new Date(td.created_at).toLocaleDateString()}),s.jsx("span",{children:"•"}),s.jsx("span",{children:td.username})]})]}),s.jsx("button",{onClick:()=>tn(null),className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 hidden md:block",title:"关闭",children:s.jsx(P.Z,{size:20})})]}),td.description&&s.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-sm mb-4 whitespace-pre-wrap",children:td.description}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("button",{onClick:()=>tS(td),disabled:!R,className:(0,L.Z)("flex items-center gap-1.5 px-3 py-1.5 rounded-lg transition-all border text-sm font-medium",td.is_liked?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 border-red-200 dark:border-red-800":"bg-slate-100 dark:bg-slate-800 text-slate-500 border-transparent hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",!R&&"opacity-50 cursor-not-allowed"),children:[s.jsx(u.Z,{size:16,className:(0,L.Z)(td.is_liked&&"fill-current")}),td.likes]}),(0,s.jsxs)("button",{onClick:()=>tC(td),disabled:!R,className:(0,L.Z)("flex items-center gap-1.5 px-3 py-1.5 rounded-lg transition-all border text-sm font-medium",td.is_collected?"bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400 border-amber-200 dark:border-amber-800":"bg-slate-100 dark:bg-slate-800 text-slate-500 border-transparent hover:text-amber-500 dark:hover:text-amber-400 hover:bg-amber-50 dark:hover:bg-amber-900/20",!R&&"opacity-50 cursor-not-allowed"),children:[s.jsx(N.Z,{size:16,className:(0,L.Z)(td.is_collected&&"fill-current")}),td.is_collected?"已收藏":"收藏"]})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 min-h-[200px]",children:tp?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(c.Z,{size:24,className:"text-purple-500 animate-spin"})}):to&&0!==to.length?to.map(e=>(0,s.jsxs)("div",{className:"flex gap-3 group",children:[s.jsx(i.default,{href:`/player/${e.username}`,children:s.jsx("img",{src:`https://cravatar.eu/helmavatar/${e.username}/32.png`,alt:e.username,className:"w-8 h-8 rounded-md flex-shrink-0 bg-slate-200 hover:opacity-80 transition-opacity"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-baseline justify-between mb-1",children:[s.jsx(i.default,{href:`/player/${e.username}`,className:"font-bold text-sm text-slate-900 dark:text-white hover:text-emerald-500 hover:underline transition-colors",children:e.username}),s.jsx("span",{className:"text-xs text-slate-400",children:new Date(e.created_at).toLocaleDateString()})]}),s.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 break-words",children:e.content})]}),R&&(R.username===e.username||R.username===td.username||eM)&&s.jsx("button",{onClick:async()=>{if(await I({title:"删除评论",message:"确定要删除这条评论吗？",isDangerous:!0,confirmText:"删除"}))try{await d.ZP.delete(`/api/album/comment/${e.id}`,{headers:{Authorization:`Bearer ${G}`}}),tc(t=>t.filter(t=>t.id!==e.id)),eO(e=>e.map(e=>e.id===td.id?{...e,comment_count:Math.max(0,e.comment_count-1)}:e)),W("删除成功")}catch(e){U("删除失败")}},className:"text-slate-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"删除评论",children:s.jsx(E.Z,{size:14})})]},e.id)):s.jsx("div",{className:"text-center py-8 text-slate-500",children:s.jsx("p",{children:"暂无评论，快来抢沙发~"})})}),s.jsx("div",{className:"p-4 border-t border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-950/30",children:R?(0,s.jsxs)("form",{onSubmit:tM,className:"relative",children:[s.jsx("input",{type:"text",value:tx,onChange:e=>tm(e.target.value),placeholder:"写下你的评论...",className:"w-full pl-4 pr-12 py-2 rounded-lg border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-purple-500 text-sm"}),s.jsx("button",{type:"submit",disabled:!tx.trim()||th,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-purple-500 hover:bg-purple-50 dark:hover:bg-purple-900/20 rounded-md disabled:opacity-50",title:"发送评论",children:th?s.jsx(c.Z,{size:16,className:"animate-spin"}):s.jsx(D.Z,{size:16})})]}):(0,s.jsxs)("div",{className:"text-center text-sm text-slate-500",children:[s.jsx(i.default,{href:"/login",className:"text-purple-500 hover:underline",children:"登录"})," 后参与评论"]})})]})]})]})}),s.jsx(o.M,{children:eq?.music_id&&s.jsx(n.E.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.9},className:"fixed bottom-6 right-6 z-40",children:(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsxs)("div",{className:"bg-white/90 dark:bg-slate-900/90 backdrop-blur-xl p-3 pr-4 rounded-full shadow-2xl border border-slate-200 dark:border-slate-800 flex items-center gap-3 transition-all hover:scale-105 hover:shadow-emerald-500/10",children:[(0,s.jsxs)("div",{className:"relative w-10 h-10 flex items-center justify-center",children:[s.jsx("div",{className:(0,L.Z)("absolute inset-0 rounded-full overflow-hidden border-2 border-slate-200 dark:border-slate-700 shadow-md bg-slate-900",eF?"animate-[spin_8s_linear_infinite]":""),children:eL?.cover?s.jsx("img",{src:eL.cover,alt:"Cover",className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full bg-[repeating-radial-gradient(#333_0,#333_2px,#000_3px,#000_4px)] opacity-50"})}),!eL?.cover&&s.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-3 h-3 bg-emerald-500 rounded-full border-2 border-white dark:border-slate-900 z-10"}),eL?.cover&&s.jsx("div",{className:"absolute w-2 h-2 bg-white/20 backdrop-blur-sm rounded-full top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 border border-white/40"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 min-w-[140px]",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col overflow-hidden",children:[s.jsx("span",{className:"text-xs font-bold text-slate-800 dark:text-slate-200 max-w-[110px] truncate leading-tight",children:eL?.name||"加载中..."}),s.jsx("span",{className:"text-[10px] text-slate-500 dark:text-slate-400 max-w-[110px] truncate leading-tight",children:eL?.artist||"网易云音乐"})]}),s.jsx("button",{onClick:()=>{eK.current&&(eF?eK.current.pause():eK.current.play())},className:"w-8 h-8 flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-full hover:bg-emerald-500 hover:text-white text-slate-700 dark:text-slate-200 transition-colors flex-shrink-0",children:eF?s.jsx(q,{size:14,className:"fill-current"}):s.jsx(A.Z,{size:14,className:"fill-current ml-0.5"})})]}),s.jsx("div",{className:"w-full h-1 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden cursor-pointer",onClick:e=>{if(eK.current){let t=e.currentTarget.getBoundingClientRect(),a=(e.clientX-t.left)/t.width;eK.current.currentTime=a*eK.current.duration,eR(100*a)}},children:s.jsx(n.E.div,{className:"h-full bg-emerald-500 rounded-full",style:{width:`${eI}%`},layoutId:"progressBar"})})]}),s.jsx("audio",{ref:eK,src:eL?.url||`https://music.163.com/song/media/outer/url?id=${eq.music_id}.mp3`,preload:"auto",loop:!0,onPlay:()=>{eT(!0),eW(!1)},onPause:()=>eT(!1),onEnded:()=>eT(!1),onError:e=>{console.error("Audio playback error:",e),eT(!1)},onTimeUpdate:()=>{if(eK.current){let e=eK.current.currentTime,t=eK.current.duration;t&&eR(e/t*100)}},className:"hidden"})]}),(0,s.jsxs)("div",{className:(0,L.Z)("absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-xs py-1 px-2 rounded transition-opacity whitespace-nowrap pointer-events-none z-50",eU?"opacity-100 animate-bounce":"opacity-0 group-hover:opacity-100"),children:[eU?"点击播放背景音乐":"正在播放用户设置的背景音乐",s.jsx("div",{className:"absolute bottom-[-4px] left-1/2 -translate-x-1/2 border-l-4 border-r-4 border-t-4 border-transparent border-t-slate-900"})]})]})})})]})}},98231:(e,t,a)=>{"use strict";a.d(t,{q:()=>s});let s=e=>{if(e<=10)return{text:"text-slate-600 dark:text-slate-300",bg:"bg-slate-100 dark:bg-slate-800",border:"border-slate-200 dark:border-slate-700",gradient:"from-slate-100 to-slate-200 dark:from-slate-800 dark:to-slate-700",shadow:"shadow-slate-500/20",icon:"text-slate-500"};if(e<=20)return{text:"text-emerald-600 dark:text-emerald-400",bg:"bg-emerald-50 dark:bg-emerald-900/20",border:"border-emerald-200 dark:border-emerald-800",gradient:"from-emerald-100 to-teal-100 dark:from-emerald-900/40 dark:to-teal-900/40",shadow:"shadow-emerald-500/20",icon:"text-emerald-500"};if(e<=30)return{text:"text-sky-600 dark:text-sky-400",bg:"bg-sky-50 dark:bg-sky-900/20",border:"border-sky-200 dark:border-sky-800",gradient:"from-sky-100 to-blue-100 dark:from-sky-900/40 dark:to-blue-900/40",shadow:"shadow-sky-500/20",icon:"text-sky-500"};if(e<=40)return{text:"text-indigo-600 dark:text-indigo-400",bg:"bg-indigo-50 dark:bg-indigo-900/20",border:"border-indigo-200 dark:border-indigo-800",gradient:"from-indigo-100 to-violet-100 dark:from-indigo-900/40 dark:to-violet-900/40",shadow:"shadow-indigo-500/20",icon:"text-indigo-500"};if(e<=50)return{text:"text-purple-600 dark:text-purple-400",bg:"bg-purple-50 dark:bg-purple-900/20",border:"border-purple-200 dark:border-purple-800",gradient:"from-purple-100 to-fuchsia-100 dark:from-purple-900/40 dark:to-fuchsia-900/40",shadow:"shadow-purple-500/20",icon:"text-purple-500"};if(e<=60)return{text:"text-pink-600 dark:text-pink-400",bg:"bg-pink-50 dark:bg-pink-900/20",border:"border-pink-200 dark:border-pink-800",gradient:"from-pink-100 to-rose-100 dark:from-pink-900/40 dark:to-rose-900/40",shadow:"shadow-pink-500/20",icon:"text-pink-500"};if(e<=70)return{text:"text-orange-600 dark:text-orange-400",bg:"bg-orange-50 dark:bg-orange-900/20",border:"border-orange-200 dark:border-orange-800",gradient:"from-orange-100 to-amber-100 dark:from-orange-900/40 dark:to-amber-900/40",shadow:"shadow-orange-500/20",icon:"text-orange-500"};else if(e<=80)return{text:"text-red-600 dark:text-red-400",bg:"bg-red-50 dark:bg-red-900/20",border:"border-red-200 dark:border-red-800",gradient:"from-red-100 to-rose-100 dark:from-red-900/40 dark:to-rose-900/40",shadow:"shadow-red-500/20",icon:"text-red-500"};else if(e<=90)return{text:"text-yellow-700 dark:text-yellow-400",bg:"bg-yellow-50 dark:bg-yellow-900/20",border:"border-yellow-200 dark:border-yellow-800",gradient:"from-yellow-100 to-amber-100 dark:from-yellow-900/40 dark:to-amber-900/40",shadow:"shadow-yellow-500/20",icon:"text-yellow-500"};else return{text:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 font-bold",bg:"bg-slate-50 dark:bg-slate-900",border:"border-indigo-200 dark:border-indigo-800",gradient:"from-indigo-100 via-purple-100 to-pink-100 dark:from-indigo-900/40 dark:via-purple-900/40 dark:to-pink-900/40",shadow:"shadow-purple-500/30",icon:"text-purple-500"}}},82932:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d,generateMetadata:()=>i,revalidate:()=>l});var s=a(19510);let r=(0,a(68570).createProxy)(String.raw`D:\编程\KukeMC-Website\KukeMC-WebSite\src\components\next\profile\ProfileClient.tsx#default`),l=60;async function i({params:e}){let t=e.username;try{let e=process.env.NEXT_PUBLIC_API_BASE||"https://api.kuke.ink",a=await fetch(`${e}/api/profile/${t}`);if(!a.ok)return{title:`${t} - 玩家不存在`,description:"该玩家不存在或从未进入过服务器。"};let s=await a.json(),r=s.bio||s.signature||`${t} 在 KukeMC 的个人主页，查看他们的游戏统计、动态和相册。`;return{title:`${t} 的个人主页 | KukeMC`,description:r,openGraph:{title:`${t} 的个人主页 | KukeMC`,description:r,images:[`https://cravatar.eu/helmavatar/${t}/256.png`]}}}catch(e){return{title:`${t} 的个人主页 | KukeMC`,description:`查看 ${t} 的游戏统计、动态和相册。`}}}function d(){return s.jsx(r,{})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[948,933,503,64,609,952,621,136,495,349],()=>a(40437));module.exports=s})();